



## 一、动态规划：一个解析解的例子

考虑一个一维的单输入、单状态的例子：
$$
x_{[k+1]} = x_{[k]} + u_{[k]}
$$

- 初始值：$x_{[0]} = 1$
- 目标值：$x_{[d]} = 0$

定义其末端为 $N=2$，代价函数定义如下：
$$
J = \frac{1}{2}X^2_{[N]} + \frac{1}{2} \sum^{N-1}_{k=0}[X^2_{[K]} + U^2_{[k]}]
$$

- $\frac{1}{2}X^2_{[N]}$ 表示末端代价
- $\frac{1}{2} \sum^{N-1}_{k=0}X^2_{[K]}$ 表示运行代价
- $\frac{1}{2} \sum^{N-1}_{k=0}U^2_{[k]}$ 表示输入代价

当$N=2$时，代价函数可写为：
$$
J = \frac{1}{2}X^2_{[2]} + \frac{1}{2} [X^2_{[1]} + U^2_{[1]} + X^2_{[0]} + U^2_{[0]}]
$$

---

**策略一：**

直接一步到位，让 $u_{[0]} = -1, u_{[1]} = 0$，快速收敛

$u_{[0]} = -1$		$\longrightarrow$		$x_{[1]} = x_{[0]} + u_{[0]} = 1 - 1 = 0$

$u_{[1]} = 0$	   	$\longrightarrow$		$x_{[2]} = x_{[1]} + u_{[1]} = 0 - 0 = 0$

​				    	$\longrightarrow$		$J = \frac{1}{2} 0^2 + \frac{1}{2} [0^2 + 0^2 + 1^2 + 1^2] = 1$

**策略二：**

分两步收敛到0，即让 $u_{[0]} = -0.5, u_{[1]} = -0.5$

$u_{[0]} = -0.5$		$\longrightarrow$		$x_{[1]} = x_{[0]} + u_{[0]} = 1 - 0.5 = 0.5$

$u_{[1]} = -0.5$	    $\longrightarrow$		$x_{[2]} = x_{[1]} + u_{[1]} = 0.5 - 0.5 = 0$

​				       	$\longrightarrow$		$J = \frac{1}{2} 0^2 + \frac{1}{2} [0.5^2 + 0.5^2 + 1^2 + 0.5^2] =  0.875$

在$N=2$时收敛，但是代价函数比策略一要小（0.875 < 1）$\longrightarrow$  **策略二优于策略一**

---

**考虑用解析的方法，求$u^*_{[0]},u^*_{[1]}$使$J$最小**

根据贝尔曼最优控制理论，采用**逆向分级**的方法，$k = 0,1,2$

先考虑 $k = 1 \longrightarrow 2$
$$
J_{1\rightarrow2} = \frac{1}{2}X^2_{[2]} + \frac{1}{2} [X^2_{[1]} + U^2_{[1]}]
$$

- $\frac{1}{2} X^2_{[1]}$ 表示$k=1$时，$x$的初始状态
- $\frac{1}{2} U^2_{[1]}$ 表示$k=1$时的控制量
- $X_{[2]} = X_{[1]} + U_{[1]}$

**求$U_{[1]}$使得$J_{1\rightarrow2}$最小**
$$
J_{1\rightarrow2} = \frac{1}{2}[X_{[1]} + U_{[1]}]^2 + \frac{1}{2} [X^2_{[1]} + U^2_{[1]}]
$$
对$J_{1\rightarrow2}$求关于$U_{[1]}$的偏导，并令其为0即可得到$U^*_{[1]}]$
$$
\frac{\partial J_{1\rightarrow2}}{\partial U_{[1]}} = X_{[1]} + U_{[1]} + U_{[1]} = 0
$$
$\longrightarrow$ $\textcolor{red}{U^*_{[1]} = -\frac{1}{2}X_{[1]}}$ 

$\longrightarrow$ 最优剩余代价：
$$
\begin{equation}
    \begin{aligned}
        \textcolor{red}{J^*_{1\rightarrow2}} &= \frac{1}{2}[X_{[1]} + U_{[1]}]^2 + \frac{1}{2} [X^2_{[1]} + U^2_{[1]}] \\
        &= \frac{1}{2}[-\frac{1}{2}X_{[1]}]^2 + \frac{1}{2} X^2_{[1]} + \frac{1}{2}[-\frac{1}{2}X^2_{[1]}] \\
        &= \textcolor{red}{\frac{3}{4} X^2_{[1]}}
    \end{aligned}
\end{equation}
$$
再倒推一级，$k = 0 \longrightarrow 2$
$$
J_{0\rightarrow2} = \frac{1}{2}X^2_{[2]} + \frac{1}{2} [X^2_{[1]} + U^2_{[1]} + X^2_{[0]} + U^2_{[0]}]
$$

- **$\frac{1}{2}X^2_{[2]} + \frac{1}{2} [X^2_{[1]} + U^2_{[1]}]$ 可以组合成 $J_{1\rightarrow2}$**

$\longrightarrow$ 
$$
J_{0\rightarrow2} = J_{1\rightarrow2} + \frac{1}{2} [X^2_{[0]} + U^2_{[0]}]
$$
**根据贝尔曼最优理论，如果$J_{0\rightarrow2}$最小，那么其中包含的$J_{1\rightarrow2}$一定是最小的** $\longrightarrow$  $J_{1\rightarrow2} = J^*_{1\rightarrow2} = \frac{3}{4} X^2_{[1]}$

因此，代价函数可写成：
$$
J_{0\rightarrow2} = \frac{3}{4} X^2_{[1]} + \frac{1}{2} [X^2_{[0]} + U^2_{[0]}] = \frac{3}{4} [X_{[0]} + U_{[0]}]^2 + \frac{1}{2} [X^2_{[0]} + U^2_{[0]}]
$$
对$J_{0\rightarrow2}$求关于$U_{[0]}$的偏导，并令其为0即可得到$U^*_{[0]}]$
$$
\frac{\partial J_{0\rightarrow2}}{\partial U_{[0]}} = \frac{3}{2}[ X_{[0]} + U_{[0]} ] + U_{[0]} = 0
$$
$\longrightarrow$ $\textcolor{red}{U^*_{[0]} = -\frac{3}{5}X_{[0]}}$ 

**综上分析计算，得到控制策略：$\textcolor{red}{U^*_{[0]} = -\frac{3}{5}X_{[0]}},\textcolor{red}{U^*_{[1]} = -\frac{1}{2}X_{[1]}}$**

$x_{[1]} = x_{[0]} + u_{[0]} = x_{[0]} -\frac{3}{5}x_{[0]} = \frac{2}{5}$

$x_{[2]} = x_{[1]} + u_{[1]} = x_{[1]} -\frac{1}{2}x_{[1]} = \frac{1}{5}$

$\longrightarrow$ $J = \frac{1}{2}X^2_{[2]} + \frac{1}{2} [X^2_{[1]} + U^2_{[1]} + X^2_{[0]} + U^2_{[0]}] = \frac{1}{2} (\frac{1}{5})^2 + \frac{1}{2}[(\frac{1}{5})^2 + (-\frac{1}{5})^2 + 1^2 + (-\frac{3}{5})^2] = 0.8 $

**优于策略一和策略二**

